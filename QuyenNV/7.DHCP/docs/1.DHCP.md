# Tìm hiểu về DHCP

## 1. DHCP là gì?

DHCP được viết tắt từ cụm từ Dynamic Host Configuration Protocol (có nghĩa là Giao thức cấu hình máy chủ). 

DHCP có nhiệm vụ giúp quản lý nhanh, tự động và tập trung việc phân phối địa chỉ IP bên trong một mạng. Ngoài ra DHCP còn giúp đưa thông tin đến các thiết bị hợp lý hơn cũng như việc cấu hình subnet mask hay cổng mặc định.

## 2. Các thành phần của DHCP

### 2.1 DHCP Client

DHCP Client là thiết bị yêu cầu và nhận thông tin cấu hình mạng từ DHCP Server. Các thiết bị như máy tính, điện thoại, hoặc máy in đóng vai trò làm DHCP Client khi cần kết nối mạng. Chúng gửi yêu cầu để nhận địa chỉ IP và các thông số mạng như Subnet Mask, Gateway, và DNS Server. Sau khi nhận được thông tin từ DHCP Server, DHCP Client sử dụng các thông số này để kết nối và giao tiếp trong mạng.

### 2.2 DHCP Server

DHCP Server là máy chủ hoặc thiết bị chịu trách nhiệm cấp phát địa chỉ IP và thông số mạng cho các DHCP Client. Nó lưu trữ một dải địa chỉ IP để phân phối, đồng thời quản lý thông tin thuê địa chỉ IP (DHCP Lease). Ngoài ra, DHCP Server cung cấp các thông tin mạng quan trọng như Subnet Mask, Gateway, và DNS Server, đảm bảo các thiết bị trong mạng có thể kết nối và giao tiếp một cách hiệu quả.

### 2.3 Binding

Binding là tập hợp các thông tin cấu hình trong đó có ít nhất một địa chỉ IP, được sử dụng bởi một DHCP Client và các kết nối được quản lý bởi DHCP Server.

### 2.4 DHCP Relay agents

DHCP Relay Agents là các thiết bị trung gian, đảm nhiệm vai trò chuyển tiếp gói tin DHCP giữa Client và Server khi chúng không nằm trong cùng một mạng (khác Subnet). Relay Agent nhận các gói tin từ DHCP Client trong mạng con và chuyển tiếp chúng đến DHCP Server. Sau khi Server phản hồi, Relay Agent gửi lại thông tin cho Client. Thành phần này rất hữu ích trong các hệ thống mạng lớn, nơi DHCP Server không được triển khai trong từng mạng con.

### 2.5 DHCP Lease

DHCP Lease là khoảng thời gian mà DHCP Server cấp phát địa chỉ IP cho một thiết bị cụ thể. Thời gian thuê này được quản lý để tối ưu hóa việc sử dụng tài nguyên địa chỉ IP trong mạng. Khi thời gian thuê sắp hết, DHCP Client có thể yêu cầu gia hạn để tiếp tục sử dụng địa chỉ IP đó. Nếu không có yêu cầu gia hạn, địa chỉ IP sẽ được giải phóng và tái sử dụng cho thiết bị khác, giúp đảm bảo việc quản lý IP hiệu quả.

## 3. DHCP hoạt động như thế nào?

![anh1](/QuyenNV/7.DHCP/images/anh1.png)

Bước 1: Khi client muốn tham gia vào mạng hoặc cần cấu hình lại địa chỉ IP, nó sẽ gửi broadcast  gói tin DHCP Discover để tìm DHCP Server hoặc được gửi trực tiếp đến DHCP Server đã biết. Gói tin này chứa địa chỉ MAC của client.

Bước 2: Khi DHCP Server nhận được yêu cầu, nếu còn khả năng cung cấp địa chỉ IP, nó sẽ gửi lại cho máy Client một gói tin DHCP Offer để đề nghị cho thuê một địa chỉ IP trong một khoảng thời gian nhất định kèm theo là một Subnet Mask và Server IP address.

Bước 3: Client nhận được gói tin DHCP Offer và chọn một trong các đề nghị cấu hình mạng trong đó. Sau đó, nó sẽ gửi broadcast lại gói tin DHCP Request đến Server để xác nhận lựa chọn của mình

Bước 4: Server nhận được gói tin DHCP Request từ client, nó gửi một gói tin DHCP Ack như như 1 lời xác nhận, gói tin này chứa địa chỉ IP và các thông tin cấu hình mạng đã được chọn (cho biết địa chỉ IP đó, Subnet Mask đó và thời hạn cho sử dụng đó sẽ chính thức được áp dụng. Ngoài ra server còn gửi kèm những thông tin bổ xung như địa chỉ default gateway, địa chỉ DNS Server)